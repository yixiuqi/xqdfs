<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="themes/metro-blue/easyui.css">
    <link rel="stylesheet" type="text/css" href="themes/icon.css">
    <link rel="stylesheet" type="text/css" href="themes/demo.css">
    <link rel="stylesheet" type="text/css" href="themes/JsonFormat.css">
    <script type="text/javascript" src="js/jquery.min.js"></script>
	<script type="text/javascript" src="js/jquery.easyui.min.js"></script>
    <script type="text/javascript" src="js/json2.js"></script>
    <script type="text/javascript" src="js/JsonFormat.js"></script>
	<script type="text/javascript" src="js/jquery.form.js"></script>
</head>
<body class="easyui-layout">
	<div class="easyui-panel" border=false style="width:100%;height:100%">
		<table>
			<tr>
				<td>
					<img id="imgOptGetImage" width="300" height="360" src=""/>
				</td>
				<td>
					<div id="txtOptGetImage_Info" style="position:absolute; top:3px;color:#F00;background:#ECECEC;border:1px solid #999;padding:0px;width:450px;height:358px;overflow:auto"/>
				</td>
			</tr>
			<tr>
				<td>
					图片地址:<input class="easyui-textbox" type="text" id="txtOpeGet_Url" style="width:245px">
				</td>
				<td>
					<a href="#" style="height:24px" class="easyui-linkbutton" onclick="btnOptGet_Get()">&nbsp;图片下载&nbsp;</a>
					<a href="#" style="height:24px" class="easyui-linkbutton" onclick="btnOptGet_Delete()">&nbsp;图片删除&nbsp;</a>
				</td>
			</tr>
		</table>		
    </div>
    
    <script>
		function btnOptGet_Get() {		
			var url=$("#txtOpeGet_Url").val();
			$.ajax({
				url: "/opt/get",
				type: "POST",
				data: "url="+url,
				success: function( response ) {	
					var options = {
						dom : '#txtOptGetImage_Info',
						isCollapsible: false
					};
					var jf = new JsonFormater(options);
					jf.doFormat(response);
				
					if(response.result==0){
						$("#imgOptGetImage").attr("src", "data:image/jpg;base64,"+response.img);
					}
				},
				error: function( jqXHR, textStatus, errorThrown ) {
				}
			});
			
			return false;
		}

		function btnOptGet_Delete() {		
			var url=$("#txtOpeGet_Url").val();
			$.ajax({
				url: "/opt/delete",
				type: "POST",
				data: "url="+url,
				success: function( response ) {	
					var options = {
						dom : '#txtOptGetImage_Info',
						isCollapsible: false
					};
					var jf = new JsonFormater(options);
					jf.doFormat(response);
				},
				error: function( jqXHR, textStatus, errorThrown ) {
				}
			});
			
			return false;
		}
	</script>
</body>
</html>